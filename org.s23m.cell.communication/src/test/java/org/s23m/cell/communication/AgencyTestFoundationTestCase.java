/* ***** BEGIN LICENSE BLOCK ***** * Version: MPL 1.1 * * The contents of this file are subject to the Mozilla Public License Version * 1.1 (the "License"); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * http://www.mozilla.org/MPL/ * * Software distributed under the License is distributed on an "AS IS" basis, * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License * for the specific language governing rights and limitations under the * License. * * The Original Code is S23M. * * The Initial Developer of the Original Code is * The S23M Foundation. * Portions created by the Initial Developer are * Copyright (C) 2012 The S23M Foundation. * All Rights Reserved. * * Contributor(s): * Andrew Shewring * ***** END LICENSE BLOCK ***** */package org.s23m.cell.communication;import org.s23m.cell.platform.S23MPlatform;import org.s23m.cell.platform.testfoundation.AgencyTestFoundation;import junit.framework.TestCase;/** * Base class for tests which use the AgencyTestFoundation features. * The instantiateFeature calls should ideally all be idempotent and * not throw errors if they are called multiple times, and we should not * need to do complex double-checked locking in several places. */public abstract class AgencyTestFoundationTestCase extends TestCase {	private static volatile Boolean agencyTestFoundationInitialised = false;	@Override	protected void setUp() throws Exception {		// initialisation must only ever be done once		if (!agencyTestFoundationInitialised) {			synchronized (agencyTestFoundationInitialised) {				if (!agencyTestFoundationInitialised) {					S23MPlatform.boot();					AgencyTestFoundation.instantiateFeature();					doAdditionalSetup();					agencyTestFoundationInitialised = true;				}			}		} else {			// already initialised - let tests perform any set up needed			doAdditionalSetup();		}	}	protected void doAdditionalSetup() {		// do nothing by default	}}